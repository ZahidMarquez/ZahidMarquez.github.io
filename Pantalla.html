<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Pantalla Pública</title>

<style>
body{margin:0;font-family:Segoe UI,sans-serif;background:#0b2a5b;color:#fff;text-align:center;}
h1{font-size:50px;margin-top:20px;}
#proximoTurno{font-size:120px;font-weight:bold;}
#nombre{font-size:50px;}
#mostrador{font-size:40px;}
.listaTurnos{margin-top:40px;display:flex;justify-content:center;gap:20px;}
.turnoCard{background:#1f1f1f;padding:20px;border-radius:10px;width:200px;}
.Centurion{border-left:8px solid gold;}
.Platino{border-left:8px solid silver;}
.Aeromexico{border-left:8px solid #b02a2a;}
@keyframes pulse{0%{transform:scale(1);}50%{transform:scale(1.05);}100%{transform:scale(1);}}
.llamado{animation:pulse .7s;}
</style>
</head>

<body>
<h1>✈ LISTA DE ESPERA</h1>
<div id="proximoTurno">0</div>
<div id="nombre">---</div>
<div id="mostrador">---</div>
<div class="listaTurnos" id="listaProximos"></div>

<script>
const proximoTurno=document.getElementById("proximoTurno");
const nombre=document.getElementById("nombre");
const mostrador=document.getElementById("mostrador");
const listaProximos=document.getElementById("listaProximos");

function actualizar(){
  const ultimo=JSON.parse(localStorage.getItem("ultimoLlamado"));
  const espera=JSON.parse(localStorage.getItem("espera"))||[];

  if(ultimo && Number(proximoTurno.innerText)!==ultimo.turno){
    proximoTurno.innerText=ultimo.turno;
    nombre.innerText=ultimo.nombre;
    mostrador.innerText=ultimo.mostrador;
    [proximoTurno,nombre,mostrador].forEach(e=>{
      e.classList.add("llamado");
      setTimeout(()=>e.classList.remove("llamado"),700);
    });
  }

  listaProximos.innerHTML="";
  espera.slice(0,5).forEach(t=>{
    listaProximos.innerHTML+=`
      <div class="turnoCard ${t.tarjeta}">
        <b>#${t.turno}</b><br>${t.nombre}<br>${t.mostrador}
      </div>`;
  });
}

window.addEventListener("storage",e=>{
  if(e.key==="limpiarPublico"){
    proximoTurno.innerText="0";
    nombre.innerText="---";
    mostrador.innerText="---";
    listaProximos.innerHTML="";
  }
});

actualizar();
setInterval(actualizar,3000);
</script>
</body>
</html>
